# AI智能阅卷助手 - 调整后开发计划

## 📋 核心需求澄清

### 🎯 使用场景
- **平台**：智学网、好分助等在线阅卷平台
- **答题卡**：平台已完成扫描，存在页面上
- **任务**：定位图片 → AI识别 → 自动评分

### ✅ 核心流程
```
1. 访问智学网/好分助阅卷页面
2. 自动定位答题卡图片位置
3. 提取图片（Base64或Blob）
4. 直接发送给AI大模型（GPT-4o/Gemini/Claude）
5. AI理解图片内容并给出评分
6. 自动同步分数到平台
```

---

## 🛠️ 调整后的开发计划

### 第一阶段：AI图片识别评分核心 (1-2周) 🥇
**目标**：实现AI直接识别图片并进行评分

#### 1.1 AI图片识别服务
- [ ] **集成支持图片的AI模型**
  - OpenAI GPT-4o（图片+文本理解）
  - Google Gemini Pro Vision
  - Claude 3 (Haiku/Sonnet/Opus)
- [ ] **实现图片Base64转换**
- [ ] **构建图片评分prompt**
- [ ] **调用AI API进行图片识别**

#### 1.2 图片识别prompt设计
```javascript
// 示例prompt
请仔细分析这张答题卡图片，识别：
1. 题目内容
2. 学生答案
3. 标准答案（如果有显示）
4. 评分维度
5. 给出的分数和建议

请按JSON格式返回：
{
  "question": "题目内容",
  "studentAnswer": "学生答案",
  "score": 85,
  "dimensions": {
    "观点明确": 28,
    "史实准确": 25,
    "论述充分": 22,
    "语言表达": 10
  },
  "reasoning": "评分理由",
  "confidence": 0.92
}
```

#### 1.3 评分引擎实现
- [ ] **单模型图片评分**
- [ ] **双模型交叉验证**（2个AI模型对比结果）
- [ ] **置信度计算**
- [ ] **评分结果解析**

#### 1.4 界面集成
- [ ] **AI试阅按钮**（分析单张图片）
- [ ] **AI自动评分**（批量处理）
- [ ] **评分进度显示**
- [ ] **结果显示界面**

**预计完成时间**：1-2周
**关键成果**：能通过AI直接识别图片并给出评分

---

### 第二阶段：答题卡图片定位 (1周) 🎯
**目标**：在智学网/好分助页面自动找到答题卡图片

#### 2.1 图片元素检测
- [ ] **智能识别答题卡图片**
  - 根据class名、id识别
  - 根据图片尺寸（答题卡通常较大）
  - 根据图片位置（在题目区域）
- [ ] **提取图片URL或Blob**
- [ ] **图片有效性验证**

#### 2.2 多平台适配
- [ ] **智学网适配**
  - 识别答题卡容器
  - 提取题目图片
  - 提取答案区域图片
- [ ] **好分助适配**
  - 识别图片元素
  - 提取答题卡图片
- [ ] **其他平台扩展**

#### 2.3 图片批量处理
- [ ] **多张图片同时提取**
- [ ] **图片编号和分类**
- [ ] **图片预览功能**

**预计完成时间**：1周
**关键成果**：能自动定位和提取页面中的答题卡图片

---

### 第三阶段：自动分数同步 (1周) 🔗
**目标**：将AI评分结果自动填写到平台

#### 3.1 分数输入框检测
- [ ] **智能识别分数输入框**
  - 根据input type="number"
  - 根据class名包含"score"
  - 根据placeholder包含"分"
- [ ] **题目编号匹配**
- [ ] **自动填写分数**

#### 3.2 自动提交
- [ ] **识别提交按钮**
- [ ] **自动点击提交**
- [ ] **提交状态监控**

#### 3.3 错误处理
- [ ] **填写失败重试**
- [ ] **异常情况提示**
- [ ] **手动修正选项**

**预计完成时间**：1周
**关键成果**：能自动将AI评分填写到平台

---

### 第四阶段：人工复核系统 (1周) 👥
**目标**：提供复核和调整功能

#### 4.1 复核界面
- [ ] **复核题目列表**
- [ ] **原图和AI评分展示**
- [ ] **分数调整滑块**
- [ ] **调整原因记录**

#### 4.2 批量复核
- [ ] **低置信度标记**
- [ ] **批量复核操作**
- [ ] **复核历史记录**

#### 4.3 质量控制
- [ ] **复核建议系统**
- [ ] **异常分数警告**
- [ ] **复核统计**

**预计完成时间**：1周
**关键成果**：完整的人工复核流程

---

### 第五阶段：数据统计和优化 (1周) 📊
**目标**：数据统计和性能优化

#### 5.1 数据统计
- [ ] **评分数据统计**
- [ ] **正确率分析**
- [ ] **AI模型表现对比**
- [ ] **使用情况统计**

#### 5.2 性能优化
- [ ] **图片压缩优化**
- [ ] **API调用优化**
- [ ] **缓存机制**
- [ ] **并发控制**

#### 5.3 数据导出
- [ ] **Excel导出**
- [ ] **PDF报告**
- [ ] **CSV数据**

**预计完成时间**：1周
**关键成果**：完善的数据统计和优化

---

## 📅 完整开发时间表

### 第1-2周：AI图片识别评分核心 🥇
- 集成GPT-4o/Gemini/Claude图片识别
- 实现图片评分流程
- 双模型验证
- 界面集成

### 第3周：答题卡图片定位 🎯
- 智能识别页面图片
- 多平台适配
- 图片提取和预览

### 第4周：自动分数同步 🔗
- 分数输入框检测
- 自动填写和提交
- 错误处理

### 第5周：人工复核系统 👥
- 复核界面
- 批量复核
- 质量控制

### 第6周：数据统计和优化 📊
- 数据统计
- 性能优化
- 数据导出

### 第7周：测试和发布
- 全面测试
- Bug修复
- 文档完善

---

## 💡 技术实现要点

### AI图片识别核心
```javascript
// 核心流程
1. 图片提取 → document.querySelector找到答题卡图片
2. Base64转换 → canvas.toDataURL()或fetch图片
3. 调用AI API → 发送图片+prompt到GPT-4o/Gemini
4. 解析结果 → JSON.parse AI返回的评分
5. 置信度验证 → 检查返回结果有效性
6. 保存结果 → 本地存储或直接填写
```

### 图片定位策略
```javascript
// 智学网图片选择器
const zhixueSelectors = [
  '.exam-paper img',
  '.question-img',
  '.answer-sheet img',
  'img[src*="paper"]',
  'img[src*="question"]'
];

// 好分助图片选择器
const haofenSelectors = [
  '.paper-image',
  '.test-img',
  '.question-item img'
];

// 根据尺寸和位置进一步筛选
const isAnswerSheet = (img) => {
  return img.width > 300 && img.height > 300;
};
```

---

## 🎯 优先开发建议

### 立即开始：第一阶段AI图片识别
1. **集成GPT-4o图片识别**
   - 测试发送图片给GPT-4o
   - 构建图片评分prompt
   - 解析返回的评分结果

2. **实现基础评分流程**
   - 单张图片 → AI → 评分结果
   - 在界面上显示评分
   - 实现Loading状态

3. **添加多模型支持**
   - 集成Gemini Vision
   - 实现双模型对比

---

## ✅ 成功指标

### 第一阶段目标
- [ ] 能成功调用GPT-4o/Gemini识别图片
- [ ] AI能返回结构化评分结果
- [ ] 评分准确率达到预期
- [ ] 界面操作流畅

### 总体目标
- [ ] 完整的答题卡识别 → AI评分 → 自动同步流程
- [ ] 支持智学网和好分助平台
- [ ] 人工复核功能完善
- [ ] 数据统计和导出功能

---

## 📝 关键决策

### AI模型选择
1. **首选**：OpenAI GPT-4o（图片+文本理解最强）
2. **备选**：Google Gemini Pro Vision（性价比高）
3. **备用**：Claude 3 Haiku（速度快）

### 平台优先级
1. **智学网**（主要目标）
2. **好分助**
3. **其他平台**（后期扩展）

---

**下一步**：开始第一阶段AI图片识别功能开发！

---

**创建时间**：2025-11-13
**版本**：v5.0
**状态**：待确认
