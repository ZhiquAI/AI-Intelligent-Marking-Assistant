# GEMINI.md: AI 阅卷助手扩展

本文档为“AI 阅卷助手扩展”项目提供了交互式的上下文说明。

## 项目概述

这是一个 Chrome 浏览器扩展，旨在辅助在“智学网” (`zhixue.com`) 在线教育平台上的阅卷工作。它将一个用户界面注入到阅卷页面中，允许用户利用各种大型语言模型 (LLM) 对学生的答案进行自动评分。

该扩展能够捕获学生答案区域的截图，将其发送到 AI 服务进行分析，然后显示建议的分数和反馈。它还提供了将分数自动填充到网页中的功能。

**关键技术:**

*   **语言:** JavaScript (ESM)
*   **打包工具:** Rollup.js
*   **平台:** Chrome 扩展 (Manifest V3)
*   **核心库:** `html2canvas` 用于屏幕截图
*   **AI 服务:** 集成了 OpenAI (GPT-4o), Google (Gemini), 阿里巴巴 (通义千问), 和智谱AI (GLM)

**项目架构:**

该扩展遵循标准的 Manifest V3 架构：

*   **`background.js` (Service Worker):** 作为后端。它负责管理 API 密钥，与外部 AI 服务通信，处理设置持久化 (`chrome.storage`)，并作为中心消息代理。
*   **`content-enhanced.js` (Content Script):** 作为前端。它被注入到 `zhixue.com` 页面中，用于渲染 UI、捕获答案区域，并与页面的 DOM 进行交互（例如，自动填充分数）。
*   **`/ui`:** 包含由内容脚本动态加载的模块化 UI 组件。
*   **`/utils`:** 包含用于安全、DOM 操作、消息传递等的共享辅助函数。
*   **`/services`:** 存放与服务相关的逻辑，很可能用于和不同的 AI 提供商交互。
*   **`/core`:** 包含应用程序不同方面的核心业务逻辑。
*   **`dist/`:** 构建输出目录，包含最终可加载的扩展文件。

## 构建与运行

**1. 安装依赖:**

```bash
npm install
```

**2. 构建扩展:**

项目使用 Rollup.js 来打包文件。构建命令会将源代码从根目录编译到 `dist/` 目录中。

```bash
npm run build
```

**3. 在 Chrome 中加载扩展:**

*   打开 Chrome 并导航到 `chrome://extensions`。
*   在右上角启用“开发者模式”。
*   点击“加载已解压的扩展程序”。
*   选择本项目中的 `dist` 目录。
*   此时，名为“智学网AI智能阅卷助手”的扩展应该已经安装好了。

## 开发规范

*   **代码风格:** 项目使用 ESLint (`.eslintrc.js`) 和 Prettier (`.prettierrc.js`) 来强制执行一致的代码风格。建议在提交代码前使用这些工具格式化代码。
*   **模块化:** 代码库按功能被组织成不同的模块（例如 `ui`, `utils`, `core`, `services`）。新的功能应该遵循这种模式。
*   **构建流程:** 所有源文件都位于根目录和子目录中。`rollup.config.mjs` 文件定义了这些文件如何被打包并复制到 `dist` 文件夹中用于生产。
*   **API 密钥:** AI 服务的 API 密钥**不会**存储在代码仓库中。它们通过扩展的 UI 进行管理，并安全地存储在 `chrome.storage.local` 中。背景脚本负责处理这些密钥的加密和解密。
*   **测试:** 项目中存在一个 `jest.config.js` 文件，表明 Jest 是用于单元测试的框架。但是，`package.json` 中没有定义测试脚本。
